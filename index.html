<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Resgate do Gerador ‚Äì Modo Emerg√™ncia (B√°sico v1.0.1)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #020617;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    .game-container {
      background: radial-gradient(circle at top, #1e293b, #020617 55%);
      border-radius: 20px;
      padding: 24px 20px;
      max-width: 520px;
      width: 92%;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.7);
      border: 1px solid #1f2937;
    }
    h1 {
      font-size: 1.5rem;
      margin-top: 0;
      margin-bottom: 8px;
      color: #38bdf8;
      text-align: center;
    }
    h2 {
      font-size: 1.1rem;
      margin: 0 0 8px 0;
      text-align: center;
      color: #e5e7eb;
    }
    .subtitle {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-bottom: 12px;
      text-align: center;
    }
    .badge {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #fbbf24;
      text-align: center;
      margin-bottom: 6px;
    }
    .disclaimer {
      font-size: 0.75rem;
      color: #9ca3af;
      text-align: center;
      margin-bottom: 16px;
    }
    .question {
      margin-bottom: 16px;
      font-size: 1rem;
      line-height: 1.4;
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 16px;
    }
    button.option-btn {
      padding: 10px 12px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: #0b1120;
      color: #e5e7eb;
      text-align: left;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.1s;
      font-size: 0.95rem;
      border: 1px solid #1f2937;
    }
    button.option-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.6);
      background: #111827;
    }
    button.option-btn:active {
      transform: translateY(0);
      box-shadow: none;
    }
    .feedback {
      min-height: 40px;
      font-size: 0.9rem;
      margin-bottom: 12px;
    }
    .score {
      font-size: 0.9rem;
      color: #a5b4fc;
      margin-bottom: 8px;
    }
    .mentor {
      font-size: 0.85rem;
      color: #facc15;
      margin-bottom: 8px;
    }

    .btn-primary {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 999px;
      background: #38bdf8;
      color: #020617;
      border: none;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.95rem;
      transition: background 0.1s, transform 0.08s, box-shadow 0.08s;
      text-align: center;
      width: 100%;
      margin-top: 8px;
    }
    .btn-primary:hover {
      background: #0ea5e9;
      transform: translateY(-1px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.5);
    }
    .btn-primary:active {
      transform: translateY(0);
      box-shadow: none;
    }
    .btn-ghost {
      display: inline-block;
      padding: 8px 14px;
      border-radius: 999px;
      background: transparent;
      color: #9ca3af;
      border: 1px solid #1f2937;
      cursor: pointer;
      font-size: 0.85rem;
      transition: background 0.1s, color 0.1s, transform 0.08s;
      width: 100%;
      margin-top: 6px;
    }
    .btn-ghost:hover {
      background: #020617;
      color: #e5e7eb;
      transform: translateY(-1px);
    }
    .tagline {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 10px;
      text-align: center;
    }
    .small {
      font-size: 0.8rem;
    }
    .mt-8 { margin-top: 8px; }
    .mt-16 { margin-top: 16px; }
    .highlight { color: #38bdf8; font-weight: bold; }
  </style>
</head>
<body>
  <div class="game-container">

    <!-- MENU -->
    <div id="menuScreen">
      <h1>Resgate do Gerador</h1>
      <div class="badge">Modo Emerg√™ncia ¬∑ B√°sico experimental</div>
      <div class="subtitle">
        Simulador introdut√≥rio para quem gosta de gerador e quer treinar decis√µes b√°sicas de emerg√™ncia.
      </div>
      <div class="disclaimer">
        Este jogo √© voltado a iniciantes e entusiastas. N√£o substitui manuais, treinamentos oficiais
        ou procedimentos espec√≠ficos de fabricantes. Use apenas como apoio educativo e divers√£o t√©cnica.
      </div>

      <button class="btn-primary" onclick="startGame()">
        Come√ßar plant√£o de emerg√™ncia
      </button>

      <button class="btn-ghost" onclick="showCredits()">
        Ver cr√©ditos
      </button>

      <div class="tagline">
        Infinita Geradores ¬∑ Vers√£o B√°sica v1.0.1 ¬∑ Emerg√™ncia
      </div>
    </div>

    <!-- JOGO -->
      <div id="gameScreen" style="display:none;">
      <div class="mentor" id="mentorBox"></div>
      <div class="score" id="score"></div>
      <div class="question" id="question"></div>
      <div class="options" id="options"></div>
      <div class="feedback" id="feedback"></div>
      <button class="btn-primary" id="nextBtn" style="display:none;">Pr√≥xima ocorr√™ncia</button>
      <button class="btn-ghost" id="retryBtn" style="display:none;">Tentar novamente esta ocorr√™ncia</button>
      <button class="btn-ghost" onclick="backToMenu()">Voltar ao menu</button>
    </div>


    <!-- FINAL -->
    <div id="endScreen" style="display:none;">
      <h2>Fim do plant√£o</h2>
      <p id="finalMessage"></p>
      <p class="small mt-8" id="finalScore"></p>
      <button class="btn-primary" onclick="restartGame()">
        Jogar de novo
      </button>
      <button class="btn-ghost" onclick="backToMenu()">
        Voltar ao menu
      </button>
      <div class="tagline mt-16">
        Vers√£o b√°sica, focada em iniciantes. Em breve: modos Profissional e Especialista.
      </div>
    </div>

    <!-- CR√âDITOS -->
    <div id="creditsScreen" style="display:none;">
      <h2>Cr√©ditos</h2>
      <p class="small">
        Conceito, vis√£o e esp√≠rito t√©cnico: <span class="highlight">Mano ‚Äì Infinita Geradores</span>.<br/>
        IA parceira de plant√£o: <span class="highlight">Akamai (GMG√™nio)</span>.
      </p>
      <p class="small mt-8">
        Este √© um m√≥dulo b√°sico e experimental, voltado a quem est√° come√ßando ou ama essas m√°quinas
        e quer treinar decis√µes de forma leve e respons√°vel.
      </p>
      <button class="btn-ghost mt-16" onclick="backToMenu()">
        Voltar ao menu
      </button>
    </div>

  </div>

  <script>
    // =========================
    // PERGUNTAS ‚Äì MODO EMERG√äNCIA (B√ÅSICO)
    // =========================
    const questionsEmergencia = [
      // P1
      {
        text: "Durante uma falta real de rede, o gerador tenta partir, gira alguns segundos e para, exibindo alarme de 'Falha de Partida'. Qual √© o primeiro passo adequado?",
        options: [
          {
            text: "Tentar uma nova partida imediatamente sem olhar os alarmes detalhados.",
            correct: false,
            feedback: "Antes de insistir na partida, √© importante entender por que o sistema bloqueou."
          },
          {
            text: "Verificar a tens√£o das baterias e checar as mensagens ativas no controlador.",
            correct: true,
            feedback: "Correto. Sem alimenta√ß√£o adequada e sem ler os alarmes, qualquer tentativa vira chute."
          },
          {
            text: "Ajustar manualmente a borboleta do acelerador para 'ajudar a pegar'.",
            correct: false,
            feedback: "Interferir mecanicamente sem diagn√≥stico el√©trico pode mascarar o problema e gerar risco."
          },
          {
            text: "Pressupor falha mec√¢nica grave e iniciar desmontagem sem diagn√≥stico el√©trico.",
            correct: false,
            feedback: "Ir direto para desmontagem √© extremo. Comece sempre pelos sinais e alimenta√ß√£o b√°sica."
          }
        ]
      },
      // P2
      {
        text: "Durante o arranque, o controlador dispara 'Baixa press√£o de √≥leo' antes do motor estabilizar. Qual a√ß√£o inicial faz mais sentido?",
        options: [
          {
            text: "Verificar n√≠vel de √≥leo, chicote do sensor e funcionamento do pressostato.",
            correct: true,
            feedback: "Perfeito. Primeiro confirme se o motor realmente tem √≥leo e se o sinal do sensor est√° correto."
          },
          {
            text: "Reiniciar o controlador v√°rias vezes esperando que o alarme desapare√ßa.",
            correct: false,
            feedback: "Reiniciar sem checar a causa pode esconder um problema real de lubrifica√ß√£o."
          },
          {
            text: "Suspender a an√°lise do alarme e tentar colocar o gerador em carga assim mesmo.",
            correct: false,
            feedback: "Nunca ignore alarme de √≥leo para colocar em carga. Risco alto de dano ao motor."
          },
          {
            text: "Suspeitar de defeito no motor sem verificar sensores e fia√ß√£o.",
            correct: false,
            feedback: "Comece pelos elementos mais simples: n√≠vel, sensor, chicote e conectores."
          }
        ]
      },
      // P3
      {
        text: "O motor pega, sustenta rota√ß√£o por 2‚Äì3 segundos e desliga. O que voc√™ verifica primeiro?",
        options: [
          {
            text: "Avaliar se h√° ar na linha de combust√≠vel e se o sistema est√° adequadamente sangrado.",
            correct: true,
            feedback: "Boa. Falhas de alimenta√ß√£o de combust√≠vel s√£o causas comuns desse comportamento."
          },
          {
            text: "Pressupor defeito em bicos injetores e j√° iniciar desmontagem.",
            correct: false,
            feedback: "Bicos s√£o mais complexos e caros. Primeiro descarte problemas simples de alimenta√ß√£o."
          },
          {
            text: "Aumentar o tempo de partida no controlador para 'insistir mais'.",
            correct: false,
            feedback: "Se o motor n√£o se mant√©m, insistir apenas for√ßa o sistema de partida."
          },
          {
            text: "Suspeitar de falha no alternador mesmo sem o motor estabilizar.",
            correct: false,
            feedback: "Alternador n√£o √© o alvo principal se o motor nem permanece ligado."
          }
        ]
      },
      // P4
      {
        text: "Ap√≥s o gerador assumir a emerg√™ncia, a frequ√™ncia oscila entre 56‚Äì62 Hz. Qual √© a abordagem inicial adequada?",
        options: [
          {
            text: "Verificar o atuador/governador eletr√¥nico e a estabilidade do controle de rota√ß√£o.",
            correct: true,
            feedback: "Exato. Oscila√ß√£o de frequ√™ncia est√° diretamente ligada ao controle de rota√ß√£o do motor."
          },
          {
            text: "Ajustar a carga manualmente, esperando que a frequ√™ncia se estabilize sozinha.",
            correct: false,
            feedback: "A carga influencia, mas o controle de rota√ß√£o √© o ponto central nessa an√°lise."
          },
          {
            text: "Verificar apenas a tens√£o de sa√≠da, pois frequ√™ncia n√£o √© t√£o importante.",
            correct: false,
            feedback: "Frequ√™ncia √© cr√≠tica para a maior parte das cargas. N√£o pode ser ignorada."
          },
          {
            text: "Trocar o combust√≠vel acreditando que o diesel pode causar oscila√ß√£o de frequ√™ncia.",
            correct: false,
            feedback: "Qualidade de combust√≠vel pode afetar desempenho, mas n√£o √© o primeiro foco aqui."
          }
        ]
      },
      // P5
      {
        text: "O gerador entra em emerg√™ncia, estabiliza a rota√ß√£o, mas a tens√£o est√° muito abaixo do nominal (por exemplo, 380 V ‚Üí 310 V). O que deve ser analisado primeiro?",
        options: [
          {
            text: "Verificar o sistema de excita√ß√£o/AVR e o sinal de feedback de tens√£o das fases.",
            correct: true,
            feedback: "Correto. AVR e sensing de tens√£o s√£o fundamentais para manter o n√≠vel adequado de tens√£o."
          },
          {
            text: "Reduzir a velocidade do motor para tentar compensar a tens√£o baixa.",
            correct: false,
            feedback: "Frequ√™ncia e tens√£o t√™m rela√ß√µes diferentes. N√£o corrija tens√£o alterando rota√ß√£o."
          },
          {
            text: "Focar apenas no quadro externo sem avaliar o alternador.",
            correct: false,
            feedback: "√â importante validar o que est√° acontecendo diretamente no conjunto gerador."
          },
          {
            text: "Assumir que o problema √© da carga e n√£o do gerador.",
            correct: false,
            feedback: "Antes de culpar a carga, confirme se o gerador est√° regulando corretamente."
          }
        ]
      },
      // P6
      {
        text: "Depois que o gerador assume a emerg√™ncia e estabiliza em carga, surge um odor de aquecimento vindo do quadro de transfer√™ncia. Qual √© a a√ß√£o inicial mais segura?",
        options: [
          {
            text: "Desligar o disjuntor principal com seguran√ßa e realizar inspe√ß√£o visual e t√©rmica.",
            correct: true,
            feedback: "Perfeito. Primeiro ato √© garantir seguran√ßa e s√≥ ent√£o investigar aquecimentos e conex√µes."
          },
          {
            text: "Manter o gerador carregado para ver se o cheiro diminui com o tempo.",
            correct: false,
            feedback: "Cheiro de queimado √© sinal de alerta, n√£o algo para esperar 'passar'."
          },
          {
            text: "Ajustar o AVR acreditando que a tens√£o pode resolver o aquecimento.",
            correct: false,
            feedback: "Aquecimento localizado geralmente est√° ligado a conex√£o, carga ou contato, n√£o apenas tens√£o."
          },
          {
            text: "Procurar mau contato apenas nas tomadas finais do cliente.",
            correct: false,
            feedback: "O quadro de transfer√™ncia tamb√©m precisa ser verificado com cuidado."
          }
        ]
      },
      // P7
      {
        text: "Durante a falta de rede, o motor gira normalmente, mas n√£o entra em combust√£o. Qual caminho diagn√≥stico deve vir primeiro?",
        options: [
          {
            text: "Verificar presen√ßa de ar na linha ou obstru√ß√£o em filtros e mangueiras de combust√≠vel.",
            correct: true,
            feedback: "Boa. Sem combust√≠vel corretamente alimentado, o motor n√£o entra em funcionamento est√°vel."
          },
          {
            text: "Suspeitar diretamente de falha no m√≥dulo do atuador.",
            correct: false,
            feedback: "Atuador pode falhar, mas √© mais l√≥gico descartar problemas simples de alimenta√ß√£o antes."
          },
          {
            text: "Aumentar o tempo de partida no controlador para ver se 'pega no insistente'.",
            correct: false,
            feedback: "Insistir na partida sem causa conhecida pode danificar sistema de partida e baterias."
          },
          {
            text: "Pressupor defeito grave no motor sem checar o sistema de alimenta√ß√£o.",
            correct: false,
            feedback: "Sempre comece pelo mais b√°sico: combust√≠vel, ar e sinais de comando."
          }
        ]
      },
      // P8
      {
        text: "O gerador entra em opera√ß√£o, mas ap√≥s alguns segundos a tens√£o colapsa para valores muito baixos. Qual √© o ponto inicial de investiga√ß√£o?",
        options: [
          {
            text: "Checar chicotes do AVR e conex√µes do circuito de sensing de tens√£o.",
            correct: true,
            feedback: "Correto. Uma perda de refer√™ncia no AVR pode fazer a excita√ß√£o cair rapidamente."
          },
          {
            text: "Medir apenas a bateria para ver se tem carga suficiente.",
            correct: false,
            feedback: "Bateria √© importante para partida, mas n√£o √© a primeira suspeita numa queda brusca de tens√£o em carga."
          },
          {
            text: "Aumentar a rota√ß√£o para tentar levantar a tens√£o manualmente.",
            correct: false,
            feedback: "Ajustar rota√ß√£o n√£o resolve um problema direto de excita√ß√£o ou sensing."
          },
          {
            text: "Desmontar diodos do alternador antes de validar sinais b√°sicos.",
            correct: false,
            feedback: "Testes invasivos devem vir depois de checar sinais simples e conex√µes."
          }
        ]
      },
      // P9
      {
        text: "O gerador est√° estabilizado, mas o contator/BTB n√£o fecha para assumir as cargas essenciais. O que verificar primeiro?",
        options: [
          {
            text: "Intertravamentos, permissivas e rel√©s de comando que liberam o fechamento.",
            correct: true,
            feedback: "Isso a√≠. Sem permissivas atendidas, o comando simplesmente n√£o autoriza o fechamento."
          },
          {
            text: "Ajustar tens√£o de sa√≠da imaginando que isso destrava o contator.",
            correct: false,
            feedback: "Se a l√≥gica de comando estiver bloqueada, apenas mudar tens√£o n√£o libera o fechamento."
          },
          {
            text: "For√ßar o fechamento manual do contator para testar se 'aguenta'.",
            correct: false,
            feedback: "For√ßar contatores √© perigoso. Confira primeiro a l√≥gica de prote√ß√£o e permissivas."
          },
          {
            text: "Alterar curvas de prote√ß√£o sem diagnosticar a causa do bloqueio.",
            correct: false,
            feedback: "Mudar prote√ß√£o sem diagn√≥stico pode mascarar problemas reais."
          }
        ]
      },
      // P10
      {
        text: "O gerador assume carga e, em poucos minutos, a temperatura da √°gua sobe rapidamente at√© alarmar. Qual √© a an√°lise inicial correta?",
        options: [
          {
            text: "Verificar fluxo do sistema de arrefecimento: ventilador, correias, mangueiras e n√≠vel de √°gua.",
            correct: true,
            feedback: "Correto. Um sistema de arrefecimento deficiente leva ao aquecimento acelerado."
          },
          {
            text: "Abaixar a carga para 'ganhar tempo' sem investigar a causa.",
            correct: false,
            feedback: "Reduzir carga pode aliviar, mas n√£o resolve o problema de fundo no arrefecimento."
          },
          {
            text: "Desligar e religar o controlador acreditando ser apenas erro de leitura.",
            correct: false,
            feedback: "Confirme o sistema de arrefecimento antes de supor falha de sensor."
          },
          {
            text: "Examinar sensores do alternador antes do sistema de arrefecimento.",
            correct: false,
            feedback: "O sintoma descrito aponta diretamente para o sistema de arrefecimento do motor."
          }
        ]
      },
      // P11
      {
        text: "Durante a emerg√™ncia, ao aplicar uma carga moderada, a tens√£o cai mais do que o esperado. Qual procedimento vem primeiro?",
        options: [
          {
            text: "Avaliar se o AVR est√° compensando corretamente e se o sinal de sensing est√° est√°vel.",
            correct: true,
            feedback: "Boa. √â importante saber se o AVR est√° enxergando corretamente a tens√£o e respondendo √† carga."
          },
          {
            text: "Reduzir a carga na tentativa de evitar o problema sem investigar.",
            correct: false,
            feedback: "Reduzir carga pode aliviar, mas n√£o explica por que a tens√£o cai tanto."
          },
          {
            text: "Suspeitar de falha no alternador antes de verificar controladores.",
            correct: false,
            feedback: "Verificar controladores e sinais √© mais simples do que partir direto para o alternador."
          },
          {
            text: "Ajustar manualmente a rota√ß√£o acreditando resolver a tens√£o.",
            correct: false,
            feedback: "Ajustar rota√ß√£o mexe na frequ√™ncia, n√£o resolve diretamente a regula√ß√£o de tens√£o."
          }
        ]
      },
      // P12
      {
        text: "Ao tentar partir em emerg√™ncia, o controlador exibe mais de um alarme (por exemplo, baixa rota√ß√£o + baixa press√£o de √≥leo). Qual abordagem √© a mais segura?",
        options: [
          {
            text: "Analisar qual alarme aparece primeiro e verificar sensores e permissivas relacionados.",
            correct: true,
            feedback: "Correto. Entender a sequ√™ncia dos alarmes ajuda a identificar a causa raiz."
          },
          {
            text: "Ignorar o alarme inicial e focar apenas na press√£o de √≥leo.",
            correct: false,
            feedback: "Ignorar a ordem dos eventos pode confundir o diagn√≥stico."
          },
          {
            text: "Reiniciar o gerador v√°rias vezes at√© algum alarme desaparecer.",
            correct: false,
            feedback: "Reiniciar sem entender a causa pode s√≥ repetir o erro e gerar desgaste."
          },
          {
            text: "Mudar curvas de prote√ß√£o antes de investigar sensores e condi√ß√µes reais.",
            correct: false,
            feedback: "Modificar prote√ß√£o sem diagn√≥stico pode comprometer a seguran√ßa do sistema."
          }
        ]
      },
      // P13
      {
        text: "O gerador parte normalmente, mas ap√≥s assumir a carga surge vibra√ß√£o percept√≠vel no conjunto. O que deve ser verificado primeiro?",
        options: [
          {
            text: "Alinhamento do conjunto, estado dos coxins e eventuais folgas estruturais.",
            correct: true,
            feedback: "Isso. Vibra√ß√£o excessiva muitas vezes est√° ligada a alinhamento e suporte mec√¢nico."
          },
          {
            text: "Tens√£o e frequ√™ncia, mesmo que j√° estejam dentro do padr√£o.",
            correct: false,
            feedback: "Tens√£o e frequ√™ncia s√£o importantes, mas o sintoma descrito √© principalmente mec√¢nico."
          },
          {
            text: "Trocar o filtro de √≥leo preventivamente.",
            correct: false,
            feedback: "Filtro de √≥leo n√£o √© o principal alvo num caso de vibra√ß√£o."
          },
          {
            text: "Ajustar o AVR acreditando que vibra√ß√£o √© problema el√©trico.",
            correct: false,
            feedback: "Vibra√ß√£o est√° mais ligada √† parte mec√¢nica do que √† regula√ß√£o de tens√£o."
          }
        ]
      },
      // P14
      {
        text: "O gerador entra em carga, mas ap√≥s alguns minutos o motor apresenta falhas intermitentes (engasgos). Qual √© o ponto inicial mais l√≥gico?",
        options: [
          {
            text: "Verificar alimenta√ß√£o de combust√≠vel: filtros, mangueiras, registros e poss√≠vel entrada de ar.",
            correct: true,
            feedback: "Exato. Problemas de alimenta√ß√£o s√£o causas frequentes de falhas intermitentes."
          },
          {
            text: "Trocar o sensor de temperatura por suspeita imediata.",
            correct: false,
            feedback: "Sensor de temperatura pode falhar, mas n√£o √© o primeiro alvo nesse sintoma."
          },
          {
            text: "Ajustar o regime de rota√ß√£o manualmente tentando 'compensar' as falhas.",
            correct: false,
            feedback: "Ajustar rota√ß√£o n√£o corrige falha de alimenta√ß√£o ou queima."
          },
          {
            text: "Aumentar ainda mais a carga esperando estabilizar o motor.",
            correct: false,
            feedback: "Se o motor j√° est√° falhando, aumentar carga tende a piorar a situa√ß√£o."
          }
        ]
      },
      // P15
      {
        text: "A rede volta ao normal, mas o sistema n√£o faz a transfer√™ncia reversa do gerador para a concession√°ria. Qual passo vem primeiro?",
        options: [
          {
            text: "Validar permissivas de retorno, supervis√£o de rede e l√≥gica do controlador.",
            correct: true,
            feedback: "Correto. Se a rede n√£o for reconhecida ou a l√≥gica estiver bloqueada, a transfer√™ncia n√£o acontece."
          },
          {
            text: "Reiniciar o controlador para for√ßar a transfer√™ncia imediata.",
            correct: false,
            feedback: "Reiniciar sem entender a causa pode apenas repetir o comportamento."
          },
          {
            text: "Assumir defeito no contator sem verificar supervis√£o de rede.",
            correct: false,
            feedback: "Antes de culpar o contator, confirme se o sistema julga a rede adequada."
          },
          {
            text: "Reduzir a carga no gerador sem avaliar a l√≥gica de transfer√™ncia.",
            correct: false,
            feedback: "A carga n√£o impede por si s√≥ a transfer√™ncia reversa se a l√≥gica estiver correta."
          }
        ]
      },
      // P16
      {
        text: "Durante a emerg√™ncia, o controlador mostra tens√µes desbalanceadas entre fases (por exemplo, 380 V, 335 V, 380 V), mas o motor est√° est√°vel. Qual √© o primeiro ponto a ser investigado?",
        options: [
          {
            text: "Verificar o circuito de sensing de tens√£o e suas conex√µes no AVR/controlador.",
            correct: true,
            feedback: "Boa. Se o sensing estiver com mau contato ou defeito, a leitura de fase pode ficar distorcida."
          },
          {
            text: "Ajustar a rota√ß√£o manualmente para tentar 'alinhar' as fases.",
            correct: false,
            feedback: "Rota√ß√£o interfere na frequ√™ncia, n√£o corrige desbalanceamento de leitura de tens√£o entre fases."
          },
          {
            text: "Reduzir a carga acreditando que o desbalanceamento desaparecer√° sozinho.",
            correct: false,
            feedback: "Se o problema estiver na medi√ß√£o, a carga n√£o resolve."
          },
          {
            text: "Desmontar o alternador antes de validar medi√ß√µes e cabos.",
            correct: false,
            feedback: "Comece sempre pelas verifica√ß√µes menos invasivas e mais simples."
          }
        ]
      },
      // P17
      {
        text: "O gerador est√° em pleno funcionamento, mas o controlador perde temporariamente comunica√ß√£o com alguns m√≥dulos (como supervis√£o ou expans√£o). Qual postura inicial √© correta?",
        options: [
          {
            text: "Verificar integridade dos cabos de comunica√ß√£o e alimenta√ß√£o dos m√≥dulos envolvidos.",
            correct: true,
            feedback: "Correto. Falhas intermitentes de comunica√ß√£o costumam envolver cabos, conectores ou alimenta√ß√£o."
          },
          {
            text: "Suspeitar imediatamente de defeito grave no controlador principal.",
            correct: false,
            feedback: "O controlador principal √© mais caro e complexo. Antes, descarte problemas simples na rede de comunica√ß√£o."
          },
          {
            text: "Desligar o gerador em emerg√™ncia para reiniciar todo o sistema.",
            correct: false,
            feedback: "Em emerg√™ncia, o desligamento deve ser muito bem avaliado. Investigue antes."
          },
          {
            text: "Alterar par√¢metros da rede de comunica√ß√£o (CAN, RS-485) sem diagn√≥stico.",
            correct: false,
            feedback: "Mudar par√¢metros sem entender a causa pode complicar o diagn√≥stico."
          }
        ]
      },
      // P18
      {
        text: "O gerador est√° est√°vel, mas ao assumir uma nova carga (por exemplo, partida de motor el√©trico) a tens√£o cai abruptamente abaixo do limite permitido. Qual an√°lise inicial faz mais sentido?",
        options: [
          {
            text: "Verificar capacidade do gerador, resposta do AVR e comportamento do regulador sob carga s√∫bita.",
            correct: true,
            feedback: "Perfeito. √â fundamental saber se o conjunto est√° dimensionado e regulado para esse tipo de carga."
          },
          {
            text: "Reduzir a rota√ß√£o para 'evitar esfor√ßo' durante a partida.",
            correct: false,
            feedback: "Reduzir rota√ß√£o s√≥ piora a frequ√™ncia e n√£o resolve a queda de tens√£o."
          },
          {
            text: "Pressupor falha no alternador sem avaliar o tipo de carga aplicada.",
            correct: false,
            feedback: "Cargas com forte corrente de partida exigem an√°lise de capacidade e ajustes de regula√ß√£o."
          },
          {
            text: "Aumentar ainda mais a carga para tentar estabilizar a tens√£o pelo esfor√ßo.",
            correct: false,
            feedback: "Se a tens√£o j√° est√° caindo demais, mais carga tende a agravar o problema."
          }
        ]
      },
      // P19
      {
        text: "Durante a emerg√™ncia, o gerador aparentemente sem comando retorna sozinho para o modo 'Auto', como se tivesse recebido um sinal externo. Qual √© a investiga√ß√£o correta?",
        options: [
          {
            text: "Checar entradas digitais, l√≥gica remota e sinais externos de comando vindos do quadro.",
            correct: true,
            feedback: "Isso mesmo. Algum sinal externo pode estar for√ßando o retorno ao modo Auto."
          },
          {
            text: "Ajustar tens√£o e frequ√™ncia acreditando que √© apenas defeito el√©trico.",
            correct: false,
            feedback: "Modo de opera√ß√£o est√° ligado √† l√≥gica de comando, n√£o s√≥ aos par√¢metros el√©tricos."
          },
          {
            text: "Trocar imediatamente o controlador sem avaliar sinais de comando.",
            correct: false,
            feedback: "Trocar o controlador sem investigar sinais √© precipitado e caro."
          },
          {
            text: "Reduzir a carga no gerador at√© que o comportamento pare.",
            correct: false,
            feedback: "A carga n√£o justifica por si s√≥ a troca de modo. √â preciso avaliar a l√≥gica de comandos."
          }
        ]
      },
      // P20
      {
        text: "O gerador assume a emerg√™ncia, mas ao aplicar uma carga aparentemente pequena j√° dispara alarme de sobrecorrente. Qual √© o passo inicial de diagn√≥stico?",
        options: [
          {
            text: "Verificar calibra√ß√£o das prote√ß√µes, transformadores de corrente (TCs) e integridade dos cabos de medi√ß√£o.",
            correct: true,
            feedback: "Correto. Um erro de ajuste ou de medi√ß√£o pode fazer a prote√ß√£o atuar antes do devido."
          },
          {
            text: "Reduzir a carga at√© que a prote√ß√£o pare de atuar, sem investigar.",
            correct: false,
            feedback: "Isso apenas contorna o sintoma, mas n√£o resolve a causa."
          },
          {
            text: "Suspeitar imediatamente de defeito no alternador, sem medir nada.",
            correct: false,
            feedback: "Antes de acusar o alternador, confirme se o sistema de medi√ß√£o e prote√ß√£o est√° ajustado corretamente."
          },
          {
            text: "Alterar o valor de sobrecorrente para bem acima do nominal, para n√£o atuar.",
            correct: false,
            feedback: "Elevar demais a prote√ß√£o pode colocar o gerador e a instala√ß√£o em risco."
          }
        ]
      }
    ];

    // =========================
    // ESTADO DO JOGO
    // =========================
    let currentIndex = 0;
    let score = 0;
    let answered = false;

    const menuScreen = document.getElementById("menuScreen");
    const gameScreen = document.getElementById("gameScreen");
    const endScreen = document.getElementById("endScreen");
    const creditsScreen = document.getElementById("creditsScreen");

      const mentorBox = document.getElementById("mentorBox");
    const scoreEl = document.getElementById("score");
    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");
    const feedbackEl = document.getElementById("feedback");
    const nextBtn = document.getElementById("nextBtn");
    const retryBtn = document.getElementById("retryBtn");
    const finalMessageEl = document.getElementById("finalMessage");
    const finalScoreEl = document.getElementById("finalScore");
    function setMentorMessage(text) {
      if (mentorBox) mentorBox.textContent = "üß¢ Germano: " + text;
    }


    // =========================
    // FUN√á√ïES DE TELA
    // =========================
    function showOnly(screen) {
      menuScreen.style.display = "none";
      gameScreen.style.display = "none";
      endScreen.style.display = "none";
      creditsScreen.style.display = "none";
      screen.style.display = "block";
    }

    function backToMenu() {
      showOnly(menuScreen);
    }

    function showCredits() {
      showOnly(creditsScreen);
    }

    // =========================
    // UTIL ‚Äì EMBARALHAR
    // =========================
    function shuffleArray(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // =========================
    // L√ìGICA DO JOGO
    // =========================
     function startGame() {
      currentIndex = 0;
      score = 0;
      answered = false;
      showOnly(gameScreen);
      setMentorMessage("Bem-vindo ao plant√£o de emerg√™ncia. Leia cada ocorr√™ncia com calma e escolha a melhor decis√£o.");
      loadQuestion();
    }


    function restartGame() {
      startGame();
    }

    function updateScore() {
      const total = questionsEmergencia.length;
      scoreEl.textContent = "Ocorr√™ncia " + (currentIndex + 1) + " de " + total + " ‚Ä¢ Pontos: " + score;
    }

     function loadQuestion() {
      answered = false;
      feedbackEl.textContent = "";
      nextBtn.style.display = "none";
      if (retryBtn) retryBtn.style.display = "none";

      const total = questionsEmergencia.length;
      const numero = currentIndex + 1;
      setMentorMessage("Ocorr√™ncia " + numero + " de " + total + ". Analise a situa√ß√£o como se estivesse no quadro de verdade.");

      const q = questionsEmergencia[currentIndex];
      questionEl.textContent = q.text;
      optionsEl.innerHTML = "";

      // cria lista de √≠ndices e embaralha
      const indices = q.options.map((_, i) => i);
      const shuffled = shuffleArray(indices);

      shuffled.forEach((idx) => {
        const opt = q.options[idx];
        const btn = document.createElement("button");
        btn.className = "option-btn";
        btn.textContent = opt.text;
        btn.onclick = function () {
          selectOption(idx);
        };
        optionsEl.appendChild(btn);
      });

      updateScore();
    }


        function selectOption(index) {
      if (answered) return;

      const q = questionsEmergencia[currentIndex];
      const chosen = q.options[index];

      answered = true;

      if (chosen.correct) {
        score++;
        feedbackEl.textContent = "‚úÖ " + chosen.feedback;
        setMentorMessage("Boa decis√£o, t√©cnico. √â esse tipo de leitura que salva gerador em plant√£o real.");
        nextBtn.style.display = "inline-block";    // vai para a pr√≥xima
        if (retryBtn) retryBtn.style.display = "none";
      } else {
        feedbackEl.textContent = "‚ùå " + chosen.feedback;
        setMentorMessage("Quase. Lembra: em emerg√™ncia, o primeiro passo √© entender a causa antes de insistir.");
        // oferece segunda chance
        if (retryBtn) retryBtn.style.display = "inline-block";
        nextBtn.style.display = "none";
      }

      updateScore();
    }


    function endGame() {
      showOnly(endScreen);
      const total = questionsEmergencia.length;
      let mensagem;

      if (score === total) {
        mensagem = "Plant√£o perfeito! Voc√™ tomou todas as decis√µes corretas neste m√≥dulo b√°sico.";
      } else if (score > total / 2) {
        mensagem = "Bom desempenho. Para um m√≥dulo b√°sico, voc√™ mostrou boa leitura de emerg√™ncia.";
      } else {
        mensagem = "Resultado abaixo do ideal. Como √© um modo b√°sico, vale repetir e treinar a l√≥gica de decis√£o.";
      }

      finalMessageEl.textContent = mensagem + " ‚Äî Germano.";
      finalScoreEl.textContent = "Pontua√ß√£o final: " + score + " de " + total + " ocorr√™ncias.";
      setMentorMessage("Plant√£o encerrado. Quando quiser, voltamos a treinar juntos.");
    }


    // Bot√£o 'Pr√≥xima ocorr√™ncia'
    nextBtn.addEventListener("click", function () {
      currentIndex++;
      if (currentIndex < questionsEmergencia.length) {
        loadQuestion();
      } else {
        endGame();
      }
    });

    // Bot√£o 'Tentar novamente esta ocorr√™ncia'
    if (retryBtn) {
      retryBtn.addEventListener("click", function () {
        // Recarrega a mesma pergunta, com alternativas embaralhadas de novo
        loadQuestion();
      });
    }

    // Tela inicial
    showOnly(menuScreen);
  </script>
</body>
</html>
